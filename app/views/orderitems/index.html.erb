<h1>Your Order</h1>
<h2>Add address for delivery</h2>

<%= render 'delivery_address/show_delivery_address' %>
<br>

<% total = 0 %>


<%= form_for :invoice, url: invoices_path do |f| %>

    <% @orders.each do |order|   %>
    <%= order.flavour.name %> : $<%= order.flavour.price %>
    <% total += order.flavour.price  %>
    <%= order.container.name %> : $<%= order.container.price %>
    <% total += order.container.price  %>
    </br>
    <% end  %>


    <article>
        <% if flash[:error].present? %>
          <div id="error_explanation">
            <p><%= flash[:error] %></p>
          </div>
        <% end %>
        <label class="amount">
          <span>Amount : <%= total %></span>
        </label>
    </article>

  <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
  <%=  hidden_field_tag :total_amount, total %>
  <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
    data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
    data-name="Ice Scream!"
    data-amount="<%= total * 100 %>"
    data-description=""
    data-locale="auto"
    data-currency="SGD"></script>

<% end %>
<%= form_for :delivery_address, url:delivery_address_create_path, remote: true  do |f| %>
<div class="container">
  <div class="notification">
<%= f.text_field :address, placeholder: 'Delivery Address ', class: 'input' %>
<p class="control">
<%= f.submit 'Add Address', class: 'button is-primary' %>
</p>
  </div>
</div>
<% end %>
